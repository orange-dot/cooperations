\begin{algorithm}[t]
\LinesNotNumbered
\caption{Alternate scaffold with standard (poor) design choices for prompts, sub-calls, and code execution}
\label{alg:bad-agent}
\KwIn{prompt $P$}
\KwOut{response $Y$}

\texttt{actions} $\gets \{\texttt{Finish},\, \texttt{Exec},\, \texttt{Search},\, \textcolor{subrlmcolor}{\texttt{sub\_LLM}}\ensuremath{_{\mathcal{M}}}\}$\;

\texttt{hist} $\gets [\texttt{Metadata(actions)},\, P]$\; \tcp*[r]{\tiny \color{red} Flaw \#1}

\While{True}{
    (\texttt{action}, \texttt{val}) $\gets$ \colorbox{llm}{\texttt{LLM}\ensuremath{_{\mathcal{M}}}\texttt{(hist)}}\;

    \If{\texttt{action} is \texttt{Finish}}{
        \Return \texttt{val}\; \tcp*[r]{\tiny \color{red} Flaw \#2}
    }

    \texttt{out} $\gets$ \colorbox{REPLCOLOR}{\texttt{RUN(action, val)}}\; \tcp*[r]{\tiny \color{red} Flaw \#3}

    \texttt{hist} $\gets$ \texttt{hist} $\Vert$ (\texttt{action}, \texttt{val}, \texttt{out})\;

    \If{\texttt{Tok(hist)} > K}{
        \texttt{hist} $\gets$ \texttt{Compact(hist)}\;
    }
}
\end{algorithm}
