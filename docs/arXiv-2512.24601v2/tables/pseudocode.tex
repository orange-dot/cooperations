\begin{algorithm}[t]
\LinesNotNumbered
\caption{A recursive language model, around LLM $\mathcal{M}$}
\label{alg:rlm-call}
\KwIn{prompt $P$}
\KwOut{response $Y$}

\texttt{state} $\gets$ \texttt{InitREPL(prompt=P)}\;

\texttt{state} $\gets$ \texttt{AddFunction(}\texttt{state},\, \textcolor{subrlmcolor}{\texttt{sub\_RLM}}\ensuremath{_{\mathcal{M}}}\texttt{)}\;

\texttt{hist} $\gets [\texttt{Metadata(state)}]$\;

\While{True}{
    \texttt{code} $\gets$ \colorbox{llm}{\texttt{LLM}\ensuremath{_{\mathcal{M}}}\texttt{(hist)}}\;

    (\texttt{state}, \texttt{stdout}) $\gets$ \colorbox{REPLCOLOR}{\texttt{REPL(state, code)}}\;

    \texttt{hist} $\gets$ \texttt{hist} $\,\Vert\,$ \texttt{code} $\,\Vert\,$ \texttt{Metadata(stdout)}\;

    \If{\texttt{state[Final]} is set}{
        \Return \texttt{state[Final]}\;
    }
}
\end{algorithm}
